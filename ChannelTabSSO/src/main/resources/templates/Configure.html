<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Java Configuration Page</title>

    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.0.0-2/css/bootstrap.min.css}"/>
    <script src='https://statics.teams.cdn.office.net/sdk/v1.6.0/js/MicrosoftTeams.min.js'></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="auth.js"></script>
</head>

<body>
    <h1>Java Configuration Channel Tab SSO Authentication</h1>
    <div id="divError" style="display: none"></div>
    <button onclick="requestConsent()" id="consent" style="display:none;">Authenticate</button>
    <div id="divGraphProfile" style="display: none"></div>

    <button onclick="(document.getElementById('icon').src = 'images/IconGray.png'); colorClickGray()">Select Gray</button>
    <img id="icon" src="images/TeamsIcon.png" alt="icon" style="width:100px" />
    <button onclick="(document.getElementById('icon').src = 'images/IconRed.png'); colorClickRed()">Select Red</button>

    <script>
	    microsoftTeams.initialize();
	    let saveGray = () => {
	        microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
	            microsoftTeams.settings.setSettings({
	                websiteUrl: window.location.origin ,
	                contentUrl: window.location.origin + "",
	                entityId: "Java Channel Configure",
	                suggestedDisplayName: "Java Channel Configure - Grey Settings"
	            });
	            saveEvent.notifySuccess();
	        });
	    }
	    let saveRed = () => {
	        microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
	            microsoftTeams.settings.setSettings({
	                websiteUrl: window.location.origin ,
	                contentUrl: window.location.origin + "",
	                entityId: "Java Channel Configure",
	                suggestedDisplayName: "Java Channel Configure - Red Settings"
	            });
	            saveEvent.notifySuccess();
	        });
	    }
	
	    //let gr = document.getElementById("gray").style;
	    //let rd = document.getElementById("red").style;
		let icon = document.getElementById("icon");
	    const colorClickGray = () => {
	    	//icon.src = 'images/iconGray.png'
	        //gr.display = "block";
	        //rd.display = "none";
	        microsoftTeams.settings.setValidityState(true);
	        saveGray()
	    }
	
	    const colorClickRed = () => {
	    	//icon.src = 'images/iconRed.png'
	        //rd.display = "block";
	        //gr.display = "none";
	        microsoftTeams.settings.setValidityState(true);
	        saveRed();
	    }
    </script>
	
<script th:src="@{/webjars/jquery/3.0.0/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/1.12.9-1/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/4.0.0-2/js/bootstrap.min.js}"></script>
</body>
</html>
